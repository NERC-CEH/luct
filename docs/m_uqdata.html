<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Peter Levy and Beth Raine" />

<meta name="date" content="2021-08-19" />

<title>[meta] Quantifying Uncertainty in Land-Use Data Sources</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Tracking Land-Use Change</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/NERC-CEH/luct">
    <span class="fa fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">[meta] Quantifying Uncertainty in Land-Use Data Sources</h1>
<h3 class="subtitle">m_uqdata</h3>
<h4 class="author">Peter Levy and Beth Raine</h4>
<h4 class="date">2021-08-19</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report"
  data-toggle="collapse" data-target="#workflowr-report">
  
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span>
</button>
</p>

<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
  <li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
  <li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> </a>
</li>
  <li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>

<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
  <p>
<strong>Last updated:</strong> 2021-09-19
</p>
  <p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 6 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 1
</p>
  <p>
<strong>Knit directory:</strong> <code>luct/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
  <p>
  
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.6.2). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
  <div class="panel-group" id="workflowr-checks">
  <div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguncommittedchanges"> <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> <strong>R Markdown file:</strong> uncommitted changes </a>
</p>
</div>
<div id="strongRMarkdownfilestronguncommittedchanges" class="panel-collapse collapse">
<div class="panel-body">
  
<p>The R Markdown file has unstaged changes. To know which version of the R Markdown file created these results, you'll want to first commit it to the Git repo. If you're still working on the analysis, you can ignore this warning. When you're finished, you can run <code>wflow_publish</code> to commit the R Markdown file and build the HTML.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
  
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it's best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20201104code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20201104)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20201104code" class="panel-collapse collapse">
<div class="panel-body">
  
<p>The command <code>set.seed(20201104)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
  
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
  
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
  
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefsshgitgithubcomNERCCEHlucttreecb43b025c3d8f43ff72d6f0657bbd118bc98814ftargetblankcb43b02a"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="ssh://git@github.com/NERC-CEH/luct/tree/cb43b025c3d8f43ff72d6f0657bbd118bc98814f" target="_blank">cb43b02</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefsshgitgithubcomNERCCEHlucttreecb43b025c3d8f43ff72d6f0657bbd118bc98814ftargetblankcb43b02a" class="panel-collapse collapse">
<div class="panel-body">
  
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>

<p>
The results in this page were generated with repository version <a href="ssh://git@github.com/NERC-CEH/luct/tree/cb43b025c3d8f43ff72d6f0657bbd118bc98814f" target="_blank">cb43b02</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>

<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>

<pre><code>
Ignored files:
    Ignored:    _targets/
    Ignored:    data-raw
    Ignored:    data/
    Ignored:    log/
    Ignored:    output/
    Ignored:    output_priorHnl_iter600k/
    Ignored:    output_priorUni_iter360k/
    Ignored:    renv/library/
    Ignored:    renv/staging/

Untracked files:
    Untracked:  slurm/run_mcmc_beta.R
    Untracked:  slurm/run_mcmc_beta.job

Unstaged changes:
    Modified:   R/luc_track.R
    Modified:   R/luct.R
    Modified:   _targets.R
    Modified:   _targets_packages.R
    Modified:   analysis/m_uqdata.Rmd
    Modified:   renv.lock

</code></pre>

<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>

</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">
  
<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/m_uqdata.Rmd</code>) and HTML (<code>docs/m_uqdata.html</code>) files. If you've configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
html
</td>
<td>
<a href="ssh://git@github.com/NERC-CEH/luct/blob/b3d846cf92cb43c1c8c68d508f6608d827e433ae/docs/m_uqdata.html" target="_blank">b3d846c</a>
</td>
<td>
ADCEH
</td>
<td>
2021-09-14
</td>
<td>
Data source exclusions target added
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="ssh://git@github.com/NERC-CEH/luct/blob/72919f23ccdf6b13af5c5699de00637ab03e01cc/docs/m_uqdata.html" target="_blank">72919f2</a>
</td>
<td>
ADCEH
</td>
<td>
2021-08-20
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="ssh://git@github.com/NERC-CEH/luct/blob/1ea3ad7e11cb8afbc6375303b769c71395be3cfd/analysis/m_uqdata.Rmd" target="_blank">1ea3ad7</a>
</td>
<td>
ADCEH
</td>
<td>
2021-08-20
</td>
<td>
Updating index
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="ssh://git@github.com/NERC-CEH/luct/blob/1ea3ad7e11cb8afbc6375303b769c71395be3cfd/docs/m_uqdata.html" target="_blank">1ea3ad7</a>
</td>
<td>
ADCEH
</td>
<td>
2021-08-20
</td>
<td>
Updating index
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="ssh://git@github.com/NERC-CEH/luct/blob/9a3642a8ce5900cbdc81be3784038a9d0050f6e0/docs/m_uqdata.html" target="_blank">9a3642a</a>
</td>
<td>
ADCEH
</td>
<td>
2021-08-19
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="ssh://git@github.com/NERC-CEH/luct/blob/0b3b4e1858e2324bf4e8606c6894080209a89d02/analysis/m_uqdata.Rmd" target="_blank">0b3b4e1</a>
</td>
<td>
ADCEH
</td>
<td>
2021-08-19
</td>
<td>
Adding data uncertainty text
</td>
</tr>
</tbody>
</table>
</div>

<hr>
</div>
</div>
</div>










<div id="introduction" class="section level1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>The Tracking Land-Use Change project uses a data assimilation approach to combining different data sources. Several different data sources provide observations of the transition matrix <span class="math">\(B\)</span>, as well as net and gross change in area of each land use (<span class="math">\(D, G, L\)</span>). The current (WP-A) method treats all data sources as equally uncertain, and assumes the same relative error for all observations. However, in reality, we know that these data sets have different levels of uncertainty: some data sets are closer to direct observations, are more plausible, and we have greater faith in these. We want to reflect this in the methodology by quantitatively associating different uncertainties with each data set. This is straightforward in principle, but potentially complicated in practice, for the following reasons.</p>
<ol style="list-style-type: decimal">
<li><p>We can consider increasing levels of detail:</p>
<ul>
<li><p>variable-specific uncertainties (i.e. different for <span class="math">\(B, G, L\)</span> &amp; <span class="math">\(D\)</span>)</p></li>
<li><p>data source type-specific uncertainties (i.e. different for ground-based vs EO data)</p></li>
<li><p>data set-specific uncertainties (i.e. different for CS, IACS, LCM etc.)</p></li>
<li><p>land-use type-specific uncertainties (i.e. different for woods, crops, grass etc.)</p></li>
<li><p>time-specific uncertainties (i.e. different for 1990, 2000 ... 2019)</p></li>
</ul></li>
<li><p>Rather than continuous data with a simple <span class="math">\(\sigma\)</span> error term, the <span class="math">\(B\)</span> observations are count data in a 6 x 6-way classification. When considering land-use <em>change</em>, we need to compare the 36 elements of this classification from one data source with another (or the truth), so we have a 36 x 36 error matrix (or &quot;confusion&quot; matrix). This matrix has two distinct types of errors that we ideally want to distinguish: false positives and false negatives, or &quot;user&quot;/&quot;commission&quot; and &quot;producer&quot;/&quot;omission&quot; error/accuracy, in the EO terminology.</p></li>
<li>We can specify uncertainty greater or lesser rigour: there are several possibilities for how we represent &quot;uncertainty&quot; in the mathematical model.</li>
<li>We can estimate uncertainty subjectively, or base it more closely on data. There are also several possibilities for how we translate measures of uncertainty in the data in to the mathematical model.</li>
<li><p>None of the data sources represents absolute truth, and we have no clear reference data set against which to calibrate.</p></li>
</ol>
</div>
<div id="representation-of-uncertainty" class="section level1">
<h1><span class="header-section-number">2</span> Representation of uncertainty</h1>
<p>The data sources are assimilated in the Bayesian method in the likelihood function, which includes a term <span class="math">\(\sigma^{obs}\)</span>, representing the standard deviatation in the probability density function for the observation. The observation is thus not assumed to be the true value, but subject to errors which make it deviate from this. Uncertainty is thus represented by the magnitude of <span class="math">\(\sigma^{obs}\)</span> - large values of <span class="math">\(\sigma^{obs}\)</span> represent high uncertainty. For each observation, a likelihood is calculated, assuming that measurement errors show a Gaussian distribution and are independent of each other. In mathematical notation, the likelihood of observing the area changing from land use <span class="math">\(i\)</span> to land use <span class="math">\(j\)</span>, <span class="math">\(\beta_{ij}^{\mathrm{obs}}\)</span>, is</p>

<p>where <span class="math">\(\beta_{ij}^{\mathrm{pred}}\)</span> is the corresponding prediction, and <span class="math">\(\sigma_{ij}^\mathrm{obs}\)</span> is the uncertainty in the observation. There are analagous terms for <span class="math">\(G, L\)</span> and <span class="math">\(\Delta A\)</span> which can all be multiplied. For example, the term for the likelihood of observing the net change in land use <span class="math">\(u\)</span>, <span class="math">\(\Delta A_{u}^{\mathrm{obs}}\)</span>, is</p>

<p>We currently assume that <em>relative</em> measurement uncertainty is the same for all observations, i.e. a constant proportion of the observed <span class="math">\(y\)</span> value. Thus, observations of large areas come with larger absolute uncertainty. The question now is how to estimate more specific uncertainties <span class="math">\(\sigma^\mathrm{obs}\)</span> for the different data sources, if not specific for each individual observation. We thus need to examine the basis for specifing these uncertainties, based on a proper quantitative analysis.</p>
</div>
<div id="defining-reference-data" class="section level1">
<h1><span class="header-section-number">3</span> Defining reference data</h1>
<p>A pre-cursor step is to define a reference data set with which we compare each data source, in the absence of ground-truth data. We could subjectively decide on a reference data set which we believe to be the most plausible or closest to the truth, based on judgement and prior knowledge. Some subjectivity is inevitable here, and would need to be justified and explicit. An alternative would be a version of the &quot;leave-one-out&quot; cross-validation idea: each data source is tested against all the other remaining data sources. With some subjective weighting applied to the data sources, the two ideas could be combined.</p>
</div>
<div id="options-for-improvement" class="section level1">
<h1><span class="header-section-number">4</span> Options for improvement</h1>
<p>We consider here some options for improving the representation of data set-specific uncertainty in the methodology. These are in increasing order of complexity, and are not mutually exclusive.</p>
<ol style="list-style-type: decimal">
<li><p>Most simply, we could base all <span class="math">\(\sigma^\mathrm{obs}\)</span> on the &quot;lowest common denominator&quot; data set, the time series of net area change <span class="math">\(\Delta A\)</span>. Irrespective of higher levels of detail, all data sources produce estimates of <span class="math">\(\Delta A\)</span>. If we define a reference data set, we can calculate a metric of agreement with this for all other data sets. Suitable metrics would be root-mean-square error (RMSE), mean-absolute error (MAE) and/or the correlation coefficient. We can use this metric as a scaling factor in estimating <span class="math">\(\sigma^\mathrm{obs}\)</span>, such that data sources with poor agreement receive high <span class="math">\(\sigma^\mathrm{obs}\)</span> (high uncertainty). Some subjectivity would come into deciding on the reference data set, which metrics to use, and the absolute values of <span class="math">\(\sigma^\mathrm{obs}\)</span>, but the relative uncertainties (and therefore weighting) would be based quantitatively on data. Extending this approach to <span class="math">\(G\)</span> and <span class="math">\(L\)</span> data would be straightforward.</p></li>
<li>Similarily, but focussing on the <span class="math">\(B\)</span> data, if we define a reference data set, we can calculate confusion matrices. We can then calculate metrics of overall agreement, and there are many such metrics - accuracy, precision, prevalence, misclassification rate, etc. There is much debate about these metrics, but a reasonable choice in our case would be the <span class="math">\(\kappa\)</span> statistic:

<p>where <span class="math">\(p_{o}\)</span> is the relative observed agreement with the reference data (the number of grid cells correctly classified), and <span class="math">\(p_{e}\)</span> is the hypothetical probability of chance agreement (calculated from the products of the confusion matrix row sums and columns sums). With perfect agreement,<span class="math">\(\kappa = 1\)</span>; with no agreement beyond what would be expected by chance, <span class="math">\(\kappa = 0\)</span>. This gives a more robust measure than simple percentage agreement, with a convenient scaling. <span class="math">\(\kappa\)</span> does not translate into an exact value for <span class="math">\(\sigma^\mathrm{obs}\)</span>, but is clearly related. We can therefore use <span class="math">\(\kappa\)</span> as a scaling factor in estimating <span class="math">\(\sigma^\mathrm{obs}\)</span>, such that data sources with low <span class="math">\(\kappa\)</span> values (poor agreement) receive high <span class="math">\(\sigma^\mathrm{obs}\)</span> (high uncertainty). The same elements of subjectivity come into this approach, but the quantity of data and level of detail used is greater. If we have the predictive probabilities associated with each prediction, we can plot the &quot;receiver operating characteristics&quot; graph or ROC, and also the Area Under the Curve (AUC). This metric has several theoretical advantages, but is more complex to calculate.</p></li>
<li>A fundamentally different approach is to explictly represent the false positive and false negative error terms in the likelihood function. False positives cause observations to over-estimate change, whilst false negatives produce an under-estimate. The estimated bias in the observation is a simple function of the false positive and false negative error rates (<span class="math">\(F_P\)</span> and <span class="math">\(F_N\)</span>) and the area (and number of grid cells) in which the false negative errors can occur, <span class="math">\(A_N\)</span>. The likelihood equation becomes:

<p>This then calculates the likelihood of the observed change from land use <span class="math">\(i\)</span> to land use <span class="math">\(j\)</span>, given that the true value is <span class="math">\(\beta_{ij}^{\mathrm{pred}}\)</span>, and with given false positive and false negative rates <span class="math">\(F_P\)</span> and <span class="math">\(F_N\)</span>, and uncertainty <span class="math">\(\sigma_{ij}^\mathrm{obs}\)</span> in the observation. This approach can be implemented in increasingly complex ways:</p>
<ul>
<li><p>estimating the false positive and false negative error rates based on some set of confusion matrices, and thereafter assuming them to be fixed and constant for a given data source;</p></li>
<li><p>as above, but calculating false positive and false negative error rates specific to each type of land-use change (i.e. <span class="math">\(F_{Pij}\)</span> and <span class="math">\(F_{Nij}\)</span>), and potentially vaying in time;</p></li>
<li><p>including the false positive and false negative error rates as unknown parameters to be calibrated, along with the <span class="math">\(B\)</span> and <span class="math">\(\sigma^{\mathrm{obs}}\)</span> values. This is the most sophisticated solution, as it properly represents the fact that these are not truly known, and allows the values to be an emergent property of the data, given prior information, rather than imposing our guesses. The exact number of these parameters to estimate could vary as above, whether specific to each data source, type of land-use change, and point in time.</p></li>
</ul></li>
</ol>
</div>
<div id="example" class="section level1">
<h1><span class="header-section-number">5</span> Example</h1>
<p>We can apply option 1 in its simplest form by basing the scaling factor for <span class="math">\(\sigma^\mathrm{obs}\)</span> on the net area change <span class="math">\(\Delta A\)</span>. We define the reference data set as the June Agricultural Census data for crops, grass and rough, and the FC data for forests. The table below shows two metrics, the RMSE and the correlation coefficient. We combine these in a multiplicative way (using <span class="math">\(1/(r^2+1)\)</span>) to give a single scaling factor for <span class="math">\(\sigma^\mathrm{obs}\)</span> (&quot;sigma_scaling&quot; in the table). The ranking shows that IACS has the lowest uncertainty and the Land Cover Crop Maps has the highest (bearing in mind all the imperfections in the reference data). This produces a quantitative means of accounting for the different relative uncertainties in these data sources.</p>
<p><img src="figure/m_uqdata.Rmd/plot_ts-1.svg" width="672" style="display: block; margin: auto;" /></p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">RMSE</th>
<th align="right">r2</th>
<th align="right">sigma</th>
<th align="right">Fp</th>
<th align="right">Fn</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AgCensus</td>
<td align="right">0.0000</td>
<td align="right">1.0000000</td>
<td align="right">164.0017</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">FC</td>
<td align="right">0.0000</td>
<td align="right">1.0000000</td>
<td align="right">164.0017</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">CORINE</td>
<td align="right">497.1706</td>
<td align="right">0.3402599</td>
<td align="right">328.0034</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">CS</td>
<td align="right">540.1346</td>
<td align="right">0.2335046</td>
<td align="right">414.0106</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">LCM</td>
<td align="right">703.8324</td>
<td align="right">0.1023783</td>
<td align="right">631.7752</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">IACS</td>
<td align="right">1118.9417</td>
<td align="right">0.0397577</td>
<td align="right">1074.4551</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">LCC</td>
<td align="right">1340.3314</td>
<td align="right">0.1350960</td>
<td align="right">1159.2580</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">CROME</td>
<td align="right">7899.3774</td>
<td align="right">-0.0819340</td>
<td align="right">8546.6052</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>An example is shown below.</p>
<pre><code>`geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>Warning: Removed 178 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>Warning in qt((1 - level)/2, df): NaNs produced</code></pre>
<pre><code>Warning: Removed 178 rows containing missing values (geom_point).</code></pre>
<pre><code>Warning in max(ids, na.rm = TRUE): no non-missing arguments to max; returning
-Inf</code></pre>
<p><img src="figure/m_uqdata.Rmd/plot_correspondence-1.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="conclusions" class="section level1">
<h1><span class="header-section-number">6</span> Conclusions</h1>
<ul>
<li>Representing data source-specific uncertainty is relatively straightforward in principle. We need to estimate appropriate <span class="math">\(\sigma\)</span> values for each data source and use these in the likelihood function.</li>
<li>The most fundamental problem is accurately estimating <span class="math">\(\sigma\)</span> in the absence of any data which we regard as &quot;true&quot;, particularly for the <span class="math">\(B\)</span> matrices which are key. There is no immediate solution to this, and a pragmatic approach is to define a reference data set, with more or less subjectivity/expert judgement, and principles from cross-validation.</li>
<li>A starting point would be to implement a simple method, whereby <span class="math">\(\sigma\)</span> for each data set is scaled according to metrics measuring its correspondence with reference data. This could be based on any or all of <span class="math">\(\Delta A, G, L\)</span> and <span class="math">\(B\)</span>.</li>
<li>A better method is to estimate the biases and uncertainties as part of the data assimilation. With confusion matrices, we have a clear method for doing this, by explicitly representing the false positive and false negative error rates. The downside of this approach is that it is more complicated, involves estimating more parameters, and will have greater computation time. Pragmatically, we would propose starting with the simple method, and implementing and testing the more complex approach as time allows.</li>
</ul>
<pre><code>Computation time (excl. render): 2.383 sec elapsed</code></pre>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo"
  data-toggle="collapse" data-target="#workflowr-sessioninfo"
  style = "display: block;">
  
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>

<div id="workflowr-sessioninfo" class="collapse">

<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.0.0 (2020-04-24)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: CentOS Linux 7 (Core)

Matrix products: default
BLAS/LAPACK: /gpfs01/apps/eb/software/OpenBLAS/0.3.9-GCC-9.3.0/lib/libopenblas_zenp-r0.3.9.so

locale:
[1] C

attached base packages:
[1] stats     graphics  grDevices datasets  utils     methods   base     

other attached packages:
 [1] ggplot2_3.3.5     units_0.7-2       data.table_1.14.0 tidyr_1.1.3      
 [5] dplyr_1.0.7       qs_0.25.1         fs_1.5.0          here_1.0.1       
 [9] tictoc_1.0.1      targets_0.6.0    

loaded via a namespace (and not attached):
 [1] tidyselect_1.1.1    xfun_0.25           bslib_0.2.5.1      
 [4] purrr_0.3.4         lattice_0.20-41     splines_4.0.0      
 [7] colorspace_2.0-2    vctrs_0.3.8         generics_0.1.0     
[10] htmltools_0.5.1.1   mgcv_1.8-33         yaml_2.2.1         
[13] utf8_1.2.2          rlang_0.4.11        jquerylib_0.1.4    
[16] later_1.2.0         pillar_1.6.2        glue_1.4.2         
[19] withr_2.4.2         lifecycle_1.0.0     stringr_1.4.0      
[22] munsell_0.5.0       gtable_0.3.0        workflowr_1.6.2    
[25] stringfish_0.15.2   codetools_0.2-18    evaluate_0.14      
[28] labeling_0.4.2      RApiSerialize_0.1.0 knitr_1.33         
[31] callr_3.7.0         httpuv_1.6.1        ps_1.6.0           
[34] fansi_0.5.0         highr_0.9           Rcpp_1.0.7         
[37] scales_1.1.1        renv_0.14.0         promises_1.2.0.1   
[40] RcppParallel_5.1.4  jsonlite_1.7.2      farver_2.1.0       
[43] digest_0.6.27       stringi_1.7.3       bookdown_0.23      
[46] processx_3.5.2      grid_4.0.0          rprojroot_2.0.2    
[49] cli_3.0.1           tools_4.0.0         magrittr_2.0.1     
[52] sass_0.4.0          tibble_3.1.3        crayon_1.4.1       
[55] whisker_0.4         pkgconfig_2.0.3     Matrix_1.3-2       
[58] ellipsis_0.3.2      rmarkdown_2.10      R6_2.5.0           
[61] nlme_3.1-152        igraph_1.2.6        git2r_0.28.0       
[64] compiler_4.0.0     </code></pre>
</div>


</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4,h5",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
