<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 3 Quantifying Uncertainty in Land-Use Data Sources | Improving Land Use Change Tracking in the UK Greenhouse Gas Inventory. Report on final outputs November 2021</title>
  <meta name="description" content="Code and documentation for the BEIS project Improving Land Use Change Tracking in the UK Greenhouse Gas Inventory" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 3 Quantifying Uncertainty in Land-Use Data Sources | Improving Land Use Change Tracking in the UK Greenhouse Gas Inventory. Report on final outputs November 2021" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Code and documentation for the BEIS project Improving Land Use Change Tracking in the UK Greenhouse Gas Inventory" />
  <meta name="github-repo" content="NERC-CEH/luc_track" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 3 Quantifying Uncertainty in Land-Use Data Sources | Improving Land Use Change Tracking in the UK Greenhouse Gas Inventory. Report on final outputs November 2021" />
  
  <meta name="twitter:description" content="Code and documentation for the BEIS project Improving Land Use Change Tracking in the UK Greenhouse Gas Inventory" />
  

<meta name="author" content="Peter Levy, Sam Tomlinson, and Beth Raine" />


<meta name="date" content="2021-11-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="quantifying-random-uncertainty-in-land-use-data-sources.html"/>
<link rel="next" href="assessing-systematic-errors-in-estimates-of-land-use-change-sensitivity-to-survey-interval-length.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Improving Land Use Change Tracking in the UK Greenhouse Gas Inventory</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#tracking-land-use-change"><i class="fa fa-check"></i><b>1.1</b> Tracking land-use change</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#approach"><i class="fa fa-check"></i><b>1.2</b> Approach</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="quantifying-random-uncertainty-in-land-use-data-sources.html"><a href="quantifying-random-uncertainty-in-land-use-data-sources.html"><i class="fa fa-check"></i><b>2</b> Quantifying Random Uncertainty in Land-Use Data Sources</a><ul>
<li class="chapter" data-level="2.1" data-path="quantifying-random-uncertainty-in-land-use-data-sources.html"><a href="quantifying-random-uncertainty-in-land-use-data-sources.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a><ul>
<li class="chapter" data-level="2.1.1" data-path="quantifying-random-uncertainty-in-land-use-data-sources.html"><a href="quantifying-random-uncertainty-in-land-use-data-sources.html#representation-of-random-uncertainty"><i class="fa fa-check"></i><b>2.1.1</b> Representation of random uncertainty</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="quantifying-random-uncertainty-in-land-use-data-sources.html"><a href="quantifying-random-uncertainty-in-land-use-data-sources.html#methods"><i class="fa fa-check"></i><b>2.2</b> Methods</a><ul>
<li class="chapter" data-level="2.2.1" data-path="quantifying-random-uncertainty-in-land-use-data-sources.html"><a href="quantifying-random-uncertainty-in-land-use-data-sources.html#estimating-sigmamathrmobs-from-reference-data"><i class="fa fa-check"></i><b>2.2.1</b> Estimating <span class="math inline">\(\sigma^\mathrm{obs}\)</span> from reference data</a></li>
<li class="chapter" data-level="2.2.2" data-path="quantifying-random-uncertainty-in-land-use-data-sources.html"><a href="quantifying-random-uncertainty-in-land-use-data-sources.html#effects-of-survey-frequency-and-survey-startstop-dates"><i class="fa fa-check"></i><b>2.2.2</b> Effects of survey frequency and survey start/stop dates</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="quantifying-random-uncertainty-in-land-use-data-sources.html"><a href="quantifying-random-uncertainty-in-land-use-data-sources.html#results"><i class="fa fa-check"></i><b>2.3</b> Results</a></li>
<li class="chapter" data-level="2.4" data-path="quantifying-random-uncertainty-in-land-use-data-sources.html"><a href="quantifying-random-uncertainty-in-land-use-data-sources.html#discussion"><i class="fa fa-check"></i><b>2.4</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="quantifying-uncertainty-in-land-use-data-sources.html"><a href="quantifying-uncertainty-in-land-use-data-sources.html"><i class="fa fa-check"></i><b>3</b> Quantifying Uncertainty in Land-Use Data Sources</a><ul>
<li class="chapter" data-level="3.1" data-path="quantifying-uncertainty-in-land-use-data-sources.html"><a href="quantifying-uncertainty-in-land-use-data-sources.html#introduction-2"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="quantifying-uncertainty-in-land-use-data-sources.html"><a href="quantifying-uncertainty-in-land-use-data-sources.html#representation-of-uncertainty"><i class="fa fa-check"></i><b>3.2</b> Representation of uncertainty</a></li>
<li class="chapter" data-level="3.3" data-path="quantifying-uncertainty-in-land-use-data-sources.html"><a href="quantifying-uncertainty-in-land-use-data-sources.html#producing-uncertainty-estimates"><i class="fa fa-check"></i><b>3.3</b> Producing uncertainty estimates</a><ul>
<li class="chapter" data-level="3.3.1" data-path="quantifying-uncertainty-in-land-use-data-sources.html"><a href="quantifying-uncertainty-in-land-use-data-sources.html#false-positive-and-negative-approach"><i class="fa fa-check"></i><b>3.3.1</b> False positive and negative approach:</a></li>
<li class="chapter" data-level="3.3.2" data-path="quantifying-uncertainty-in-land-use-data-sources.html"><a href="quantifying-uncertainty-in-land-use-data-sources.html#creating-reference-datasets"><i class="fa fa-check"></i><b>3.3.2</b> Creating reference datasets:</a></li>
<li class="chapter" data-level="3.3.3" data-path="quantifying-uncertainty-in-land-use-data-sources.html"><a href="quantifying-uncertainty-in-land-use-data-sources.html#confusion-matrices"><i class="fa fa-check"></i><b>3.3.3</b> Confusion matrices</a></li>
<li class="chapter" data-level="3.3.4" data-path="quantifying-uncertainty-in-land-use-data-sources.html"><a href="quantifying-uncertainty-in-land-use-data-sources.html#data-set-level-false-positive-and-false-negative-rates"><i class="fa fa-check"></i><b>3.3.4</b> Data-set level false positive and false negative rates</a></li>
<li class="chapter" data-level="3.3.5" data-path="quantifying-uncertainty-in-land-use-data-sources.html"><a href="quantifying-uncertainty-in-land-use-data-sources.html#updating-b-d-g-and-l"><i class="fa fa-check"></i><b>3.3.5</b> Updating <span class="math inline">\(B, D, G\)</span> and <span class="math inline">\(L\)</span></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="quantifying-uncertainty-in-land-use-data-sources.html"><a href="quantifying-uncertainty-in-land-use-data-sources.html#conclusions"><i class="fa fa-check"></i><b>3.4</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="assessing-systematic-errors-in-estimates-of-land-use-change-sensitivity-to-survey-interval-length.html"><a href="assessing-systematic-errors-in-estimates-of-land-use-change-sensitivity-to-survey-interval-length.html"><i class="fa fa-check"></i><b>4</b> Assessing systematic errors in estimates of land-use change: sensitivity to survey-interval length</a><ul>
<li class="chapter" data-level="4.1" data-path="assessing-systematic-errors-in-estimates-of-land-use-change-sensitivity-to-survey-interval-length.html"><a href="assessing-systematic-errors-in-estimates-of-land-use-change-sensitivity-to-survey-interval-length.html#introduction-3"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="assessing-systematic-errors-in-estimates-of-land-use-change-sensitivity-to-survey-interval-length.html"><a href="assessing-systematic-errors-in-estimates-of-land-use-change-sensitivity-to-survey-interval-length.html#methods-1"><i class="fa fa-check"></i><b>4.2</b> Methods</a></li>
<li class="chapter" data-level="4.3" data-path="assessing-systematic-errors-in-estimates-of-land-use-change-sensitivity-to-survey-interval-length.html"><a href="assessing-systematic-errors-in-estimates-of-land-use-change-sensitivity-to-survey-interval-length.html#results-1"><i class="fa fa-check"></i><b>4.3</b> Results</a><ul>
<li class="chapter" data-level="4.3.1" data-path="assessing-systematic-errors-in-estimates-of-land-use-change-sensitivity-to-survey-interval-length.html"><a href="assessing-systematic-errors-in-estimates-of-land-use-change-sensitivity-to-survey-interval-length.html#iacs"><i class="fa fa-check"></i><b>4.3.1</b> IACS:</a></li>
<li class="chapter" data-level="4.3.2" data-path="assessing-systematic-errors-in-estimates-of-land-use-change-sensitivity-to-survey-interval-length.html"><a href="assessing-systematic-errors-in-estimates-of-land-use-change-sensitivity-to-survey-interval-length.html#lcm"><i class="fa fa-check"></i><b>4.3.2</b> LCM</a></li>
<li class="chapter" data-level="4.3.3" data-path="assessing-systematic-errors-in-estimates-of-land-use-change-sensitivity-to-survey-interval-length.html"><a href="assessing-systematic-errors-in-estimates-of-land-use-change-sensitivity-to-survey-interval-length.html#lcc"><i class="fa fa-check"></i><b>4.3.3</b> LCC:</a></li>
<li class="chapter" data-level="4.3.4" data-path="assessing-systematic-errors-in-estimates-of-land-use-change-sensitivity-to-survey-interval-length.html"><a href="assessing-systematic-errors-in-estimates-of-land-use-change-sensitivity-to-survey-interval-length.html#crome"><i class="fa fa-check"></i><b>4.3.4</b> CROME:</a></li>
<li class="chapter" data-level="4.3.5" data-path="assessing-systematic-errors-in-estimates-of-land-use-change-sensitivity-to-survey-interval-length.html"><a href="assessing-systematic-errors-in-estimates-of-land-use-change-sensitivity-to-survey-interval-length.html#corine"><i class="fa fa-check"></i><b>4.3.5</b> CORINE:</a></li>
<li class="chapter" data-level="4.3.6" data-path="assessing-systematic-errors-in-estimates-of-land-use-change-sensitivity-to-survey-interval-length.html"><a href="assessing-systematic-errors-in-estimates-of-land-use-change-sensitivity-to-survey-interval-length.html#summary-table"><i class="fa fa-check"></i><b>4.3.6</b> Summary Table</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="assessing-systematic-errors-in-estimates-of-land-use-change-sensitivity-to-survey-interval-length.html"><a href="assessing-systematic-errors-in-estimates-of-land-use-change-sensitivity-to-survey-interval-length.html#discussion-and-conclusions"><i class="fa fa-check"></i><b>4.4</b> Discussion and Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="estimating-false-positive-rates-in-detection-of-land-use-change-based-on-classification-accuracy.html"><a href="estimating-false-positive-rates-in-detection-of-land-use-change-based-on-classification-accuracy.html"><i class="fa fa-check"></i><b>5</b> Estimating false-positive rates in detection of land-use change based on classification accuracy</a><ul>
<li class="chapter" data-level="5.1" data-path="estimating-false-positive-rates-in-detection-of-land-use-change-based-on-classification-accuracy.html"><a href="estimating-false-positive-rates-in-detection-of-land-use-change-based-on-classification-accuracy.html#introduction-4"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="estimating-false-positive-rates-in-detection-of-land-use-change-based-on-classification-accuracy.html"><a href="estimating-false-positive-rates-in-detection-of-land-use-change-based-on-classification-accuracy.html#methods-2"><i class="fa fa-check"></i><b>5.2</b> Methods</a></li>
<li class="chapter" data-level="5.3" data-path="estimating-false-positive-rates-in-detection-of-land-use-change-based-on-classification-accuracy.html"><a href="estimating-false-positive-rates-in-detection-of-land-use-change-based-on-classification-accuracy.html#results-2"><i class="fa fa-check"></i><b>5.3</b> Results</a></li>
<li class="chapter" data-level="5.4" data-path="estimating-false-positive-rates-in-detection-of-land-use-change-based-on-classification-accuracy.html"><a href="estimating-false-positive-rates-in-detection-of-land-use-change-based-on-classification-accuracy.html#conclusions-1"><i class="fa fa-check"></i><b>5.4</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="using-life-tables-in-modelling-land-use-change.html"><a href="using-life-tables-in-modelling-land-use-change.html"><i class="fa fa-check"></i><b>6</b> Using life tables in modelling land-use change</a><ul>
<li class="chapter" data-level="6.1" data-path="using-life-tables-in-modelling-land-use-change.html"><a href="using-life-tables-in-modelling-land-use-change.html#introduction-5"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="using-life-tables-in-modelling-land-use-change.html"><a href="using-life-tables-in-modelling-land-use-change.html#illustration-with-dummy-data"><i class="fa fa-check"></i><b>6.2</b> Illustration with dummy data</a></li>
<li class="chapter" data-level="6.3" data-path="using-life-tables-in-modelling-land-use-change.html"><a href="using-life-tables-in-modelling-land-use-change.html#next-steps"><i class="fa fa-check"></i><b>6.3</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="results-england.html"><a href="results-england.html"><i class="fa fa-check"></i><b>7</b> Results: England</a></li>
<li class="chapter" data-level="8" data-path="results-scotland.html"><a href="results-scotland.html"><i class="fa fa-check"></i><b>8</b> Results: Scotland</a></li>
<li class="chapter" data-level="9" data-path="results-wales.html"><a href="results-wales.html"><i class="fa fa-check"></i><b>9</b> Results: Wales</a></li>
<li class="chapter" data-level="10" data-path="results-northern-ireland.html"><a href="results-northern-ireland.html"><i class="fa fa-check"></i><b>10</b> Results: Northern Ireland</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Improving Land Use Change Tracking in the UK Greenhouse Gas Inventory. Report on final outputs November 2021</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="quantifying-uncertainty-in-land-use-data-sources" class="section level1">
<h1><span class="header-section-number">Section 3</span> Quantifying Uncertainty in Land-Use Data Sources</h1>
<div id="introduction-2" class="section level2">
<h2><span class="header-section-number">3.1</span> Introduction</h2>
<p>The spatial datasets used in the data assimilation for Land Use Tracking will contain systematic errors, related to falsely detecting land-use change when it has not occurred, and missing true land-use change when it does occur.
To characterise uncertainties in the data, we want to quantify these false positive and false negative detection rates.
These can be estimated by comparison with a reference dataset, and thereby judging where the observed changes in a given data set are correctly identified or not.
For observations of the <span class="math inline">\(B\)</span> matrix, this is complicated by the fact that they form a 6 x 6-way classification. When considering land-use <em>change</em>, we need to compare the 36 elements of this classification from one data source with another (or the truth), so we have a 36 x 36 error matrix (or “confusion” matrix). This matrix has two distinct types of errors that we ideally want to distinguish: false positives and false negatives, or “user”/“commission” and “producer”/“omission” error/accuracy, in the terminology commonly used in remote sensing.</p>
<p>As with estimating random uncertainty, a limitation is that none of the data sources represents absolute truth, and we have no definitive data set against which to make this assessment.</p>
</div>
<div id="representation-of-uncertainty" class="section level2">
<h2><span class="header-section-number">3.2</span> Representation of uncertainty</h2>
<p>Our approach here is to explicitly represent the false positive and false negative error terms in the likelihood function. False positives cause observations to over-estimate change, whilst false negatives produce an under-estimate. The estimated bias in the observation is a simple function of the false positive and false negative error rates (<span class="math inline">\(F_P\)</span> and <span class="math inline">\(F_N\)</span>) and the area (and number of grid cells) in which the false negative errors can occur, <span class="math inline">\(A_N\)</span>. The likelihood equation becomes:
<span class="math display">\[\begin{equation} \label{eq:likBetaDelta}
 \mathcal{L} = \frac{1}{\sigma_{ij}^\mathrm{obs} \sqrt{2\pi}} \mathrm{exp}(-((1-F_P) \beta_{ij}^{\mathrm{obs}} + A_N F_N - \beta_{ij}^{\mathrm{pred}})^2/2 {\sigma_{ij}^\mathrm{obs}}^2)
\end{equation}\]</span>
This then calculates the likelihood of the observed change from land use <span class="math inline">\(i\)</span> to land use <span class="math inline">\(j\)</span>, given that the true value is <span class="math inline">\(\beta_{ij}^{\mathrm{pred}}\)</span>, and with given false positive and false negative rates <span class="math inline">\(F_P\)</span> and <span class="math inline">\(F_N\)</span>, and uncertainty <span class="math inline">\(\sigma_{ij}^\mathrm{obs}\)</span> in the observation. This approach can be implemented in increasingly complex ways:</p>
<pre><code>- estimating the false positive and false negative error rates based on some set of confusion matrices, and thereafter assuming them to be fixed and constant for a given data source;

- as above, but calculating false positive and false negative error rates specific to each type of land-use change (i.e. $F_{Pij}$ and $F_{Nij}$), and potentially vaying in time;

- including the false positive and false negative error rates as unknown parameters to be calibrated, along with the $B$ and $\sigma^{\mathrm{obs}}$ values. This is the most sophisticated solution, as it properly represents the fact that these are not truly known, and allows the values to be an emergent property of the data, given prior information, rather than imposing our guesses.  The exact number of these parameters to estimate could vary as above, whether specific to each data source, type of land-use change, and point in time.</code></pre>
</div>
<div id="producing-uncertainty-estimates" class="section level2">
<h2><span class="header-section-number">3.3</span> Producing uncertainty estimates</h2>
<p>We explored the variability in false positive and false negative rates in the datasets at the land-use, data-source and time levels to identify the most appropriate way to account for uncertainty in the data assimilation. The definition of the reference data, calculation of false positives and negatives, and application of these values into the likelihood function is presented below.</p>
<p><img src="bias1_files/figure-html/plot_ts-1.png" width="672" /></p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">RMSE</th>
<th align="right">r2</th>
<th align="right">sigma</th>
<th align="right">Fp</th>
<th align="right">Fn</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AgCensus</td>
<td align="right">0.00000</td>
<td align="right">1.0000000</td>
<td align="right">4.46397</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">FC</td>
<td align="right">0.00000</td>
<td align="right">1.0000000</td>
<td align="right">4.46397</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">CORINE</td>
<td align="right">170.53335</td>
<td align="right">0.9476470</td>
<td align="right">8.92794</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">CS</td>
<td align="right">58.21941</td>
<td align="right">0.7358905</td>
<td align="right">15.37630</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">LCM</td>
<td align="right">378.85076</td>
<td align="right">0.2222080</td>
<td align="right">294.66711</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">LCC</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">IACS</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">CROME</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>An example is shown below.</p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="bias1_files/figure-html/plot_correspondence-1.png" width="672" /></p>
<div id="false-positive-and-negative-approach" class="section level3">
<h3><span class="header-section-number">3.3.1</span> False positive and negative approach:</h3>
</div>
<div id="creating-reference-datasets" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Creating reference datasets:</h3>
<p>We created the reference data by combining several spatially explicit data sources that are thought to have the highest accuracy and reliability for certain land use types, namely FC, IACS and LCM. These data-sources were added to the reference dataset in order meaning land use defined in FC data took precedent over IACS, followed by LCM. This was considered the most sensible approach to build the dataset based on reliability of land use classes in each dataset meant the overall reference raster would be as reliable as possible and also limit the number of undefined cells. This resulted in a reference dataset that includes the majority of forest cells from FC, the majority of crop, grass and rough grazing from IACS and the majority of urban and other cells from LCM.
This reference data was used to compare the other data-sources against (LCC, CORINE, CROME). In order to test FC, IACS and LCM themselves, we removed the respective dataset from the reference data, and tested land use change classifications against those present in the remaining reference data(e.g. testing the forest, crop, grassland or rough grazing land use change in IACS against that defined in FC and LCM).</p>
<p>This method enabled us to build reference rasters for England for 2006, 2010, 2015, 2017, 2018 and 2019, the 2010 reference raster for LCC, CORINE and CROME (including FC, IACS and LCM) is shown below, as well as the 2010 reference raster for testing IACS (including FC and LCM). In the IACS reference dataset, land use from LCM is used in place of IACS.</p>
<p><img src="bias1_files/figure-html/unnamed-chunk-1-1.png" width="50%" /><img src="bias1_files/figure-html/unnamed-chunk-1-2.png" width="50%" />
The table below shows the reference data contents for each data source:</p>
<table>
<thead>
<tr class="header">
<th align="left">Dataset</th>
<th align="left">Reference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">FC</td>
<td align="left">IACS, LCM</td>
</tr>
<tr class="even">
<td align="left">IACS</td>
<td align="left">FC, LCM</td>
</tr>
<tr class="odd">
<td align="left">LCM</td>
<td align="left">FC, IACS</td>
</tr>
<tr class="even">
<td align="left">LCC</td>
<td align="left">FC, IACS, LCM</td>
</tr>
<tr class="odd">
<td align="left">CORINE</td>
<td align="left">FC, IACS, LCM</td>
</tr>
<tr class="even">
<td align="left">CROME</td>
<td align="left">FC, IACS, LCM</td>
</tr>
</tbody>
</table>
</div>
<div id="confusion-matrices" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Confusion matrices</h3>
<p>The reference data is then used to compare land use change between two years in the test data source to what we have assumed as the correct land use change between these years. The 36*36 confusion matrix produced gives the total change from one land use to another identified in the reference raster as column sums, and the total change from one land use to another identified in the test data as the row sums. The diagonal identifies the area of land use change that was identified to occur in both the reference and test data sets. This is used to calculate the false positive and false negative rates for each land use type.</p>
<div id="false-positive-rates" class="section level4">
<h4><span class="header-section-number">3.3.3.1</span> False positive rates</h4>
<p>The false positive rate, the rate of incorrectly observing the area changing from land use <span class="math inline">\(i\)</span> to land use <span class="math inline">\(j\)</span> in the test dataset compared to the reference dataset, is calculated as:</p>
<p><span class="math inline">\(F_{Pij}\)</span> = (<span class="math inline">\(B_{test,ij}\)</span> - <span class="math inline">\(B_{ref,ij}\)</span>)/ <span class="math inline">\(B_{test,ij}\)</span></p>
<p>Where <span class="math inline">\(B_{test,ij}\)</span> is the total observed area of land changing in the test dataset and <span class="math inline">\(B_{ref,ij}\)</span> the total area in the reference dataset.</p>
</div>
<div id="false-negative-rates" class="section level4">
<h4><span class="header-section-number">3.3.3.2</span> False negative rates</h4>
<p>The false negative rate, the rate of failing to observe land use change from <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span> in the test dataset compared to the reference dataset, is calculated as:</p>
<p><span class="math inline">\(F_{Nij}\)</span> = (<span class="math inline">\(B_{ref,ij}\)</span> - <span class="math inline">\(B_{ref,test,ij}\)</span>)/ <span class="math inline">\(c\)</span> - <span class="math inline">\(B_{test,ij}\)</span></p>
<p>Where <span class="math inline">\(B_{ref,test,ij}\)</span> is the total area of land changing from <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span> identified in both the reference and test dataset and <span class="math inline">\(c\)</span> is the total area of England, making the denominator the total available land area that could have changed from <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span> in the test dataset but did not.</p>
<p>Here we use CORINE as an example showing the false positive and negative rates calculated between the data source and the reference dataset between 2006 and 2018 (most recent years available for comparison). The data shows the trend across all of the data-sources: low false negative rates and high false positive rates, with slightly lower false positive rates for the land use change between crop and grassland. The matrices below show the false positive/negative rate for each land use change between the first year (row) and the second year (column).</p>
<p>False positive rates for CORINE between 2006 and 2018:</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">woods</th>
<th align="left">crops</th>
<th align="left">grass</th>
<th align="left">rough</th>
<th align="left">urban</th>
<th align="left">other</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">woods</td>
<td align="left"></td>
<td align="left">1</td>
<td align="left">0.992</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">crops</td>
<td align="left">0.977</td>
<td align="left"></td>
<td align="left">0.928</td>
<td align="left">0.949</td>
<td align="left">0.994</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">grass</td>
<td align="left">0.951</td>
<td align="left">0.767</td>
<td align="left"></td>
<td align="left">0.996</td>
<td align="left">0.991</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">rough</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left"></td>
<td align="left">1</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">urban</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">0.985</td>
<td align="left">1</td>
<td align="left"></td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">other</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p>False negative rates for CORINE between 2006 and 2018:</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">woods</th>
<th align="left">crops</th>
<th align="left">grass</th>
<th align="left">rough</th>
<th align="left">urban</th>
<th align="left">other</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">woods</td>
<td align="left"></td>
<td align="left">0</td>
<td align="left">0.001</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">crops</td>
<td align="left">0.004</td>
<td align="left"></td>
<td align="left">0.038</td>
<td align="left">0.001</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">grass</td>
<td align="left">0.01</td>
<td align="left">0.053</td>
<td align="left"></td>
<td align="left">0.009</td>
<td align="left">0.001</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">rough</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0.011</td>
<td align="left"></td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">urban</td>
<td align="left">0.004</td>
<td align="left">0</td>
<td align="left">0.002</td>
<td align="left">0.003</td>
<td align="left"></td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">other</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p>The following graphs show the false positive and false negative rates for each data source, with the grid of graphs showing the land use type in the first year and colour showing the land use in the second year.</p>
<p>False positive rates:
<img src="bias1_files/figure-html/graphing%20false%20positives-1.png" width="672" /></p>
<p>False negative rates:
<img src="bias1_files/figure-html/graphing%20false%20negatives-1.png" width="672" /></p>
</div>
</div>
<div id="data-set-level-false-positive-and-false-negative-rates" class="section level3">
<h3><span class="header-section-number">3.3.4</span> Data-set level false positive and false negative rates</h3>
<p>Based on the very high false positive rates identified for many of the land use change classes, we have chosen to implement false positive rates at the data-set level rather than land-use level.We are not integrating the false negative rate to the likelihood function at this point as they are strongly influenced by the form of the reference dataset and as a result are highly subjective. Data-set level false positive rates were calculated as an average of the land-use level false positive rate, weighted by area of each land-use change.</p>
<p>This gave the following outputs which could be incorporated into the data assimilation method:</p>
<table>
<thead>
<tr class="header">
<th align="left">Data source</th>
<th align="right">Fn</th>
<th align="right">Fp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">FC</td>
<td align="right">0.0020230</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">LCM</td>
<td align="right">0.0013481</td>
<td align="right">0.8711168</td>
</tr>
<tr class="odd">
<td align="left">CORINE</td>
<td align="right">0.0060332</td>
<td align="right">0.9029868</td>
</tr>
<tr class="even">
<td align="left">LCC</td>
<td align="right">0.0012670</td>
<td align="right">0.6737150</td>
</tr>
<tr class="odd">
<td align="left">IACS</td>
<td align="right">0.0020691</td>
<td align="right">0.7997226</td>
</tr>
<tr class="even">
<td align="left">CROME</td>
<td align="right">0.0012571</td>
<td align="right">0.9329713</td>
</tr>
</tbody>
</table>
</div>
<div id="updating-b-d-g-and-l" class="section level3">
<h3><span class="header-section-number">3.3.5</span> Updating <span class="math inline">\(B, D, G\)</span> and <span class="math inline">\(L\)</span></h3>
<p>To incorporate the false positives into the Tracking Land-Use Change data assimilation approach to account for uncertainty in the data-sets, we can apply the false positive rates to the <span class="math inline">\(B\)</span> transition matrix: <span class="math inline">\(B\)</span> * (1-<span class="math inline">\(Fp\)</span>).</p>
<p>The revised <span class="math inline">\(B\)</span> matrix can then be used to recalculate <span class="math inline">\(D, G\)</span> and <span class="math inline">\(L\)</span> for each data source. An example is provided below for IACS from 2005 to 2019:</p>
<p><img src="bias1_files/figure-html/updating%20BLAG-1.png" width="672" /></p>
</div>
</div>
<div id="conclusions" class="section level2">
<h2><span class="header-section-number">3.4</span> Conclusions</h2>
<ul>
<li>Representing data source-specific random uncertainty is relatively straightforward in principle. We need to estimate appropriate <span class="math inline">\(\sigma\)</span> values for each data source and use these in the likelihood function.</li>
<li>The most fundamental problem is accurately estimating <span class="math inline">\(\sigma\)</span> in the absence of any data which we regard as “true”, particularly for the <span class="math inline">\(B\)</span> matrices which are key. There is no immediate solution to this, and a pragmatic approach is to define a reference data set, with more or less subjectivity/expert judgement, and principles from cross-validation.</li>
<li>A starting point would be to implement a simple method, whereby <span class="math inline">\(\sigma\)</span> for each data set is scaled according to metrics measuring its correspondence with reference data. This could be based on any or all of <span class="math inline">\(D, G, L\)</span> and <span class="math inline">\(B\)</span>.</li>
<li>A better method is to estimate the biases and uncertainties as part of the data assimilation. With confusion matrices, we have a clear method for doing this, by explicitly representing the false positive and false negative error rates. The downside of this approach is that it is more complicated, involves estimating more parameters, and will have greater computation time.</li>
<li>Here we have demonstrated the generation of both <span class="math inline">\(sigma\)</span> to use as scaling and also the generation of false positive and negative error rates. In both cases, the sticking point remains defining a suitable reference data-set where all of the available data sources, including ground-truthed data, are flawed in some way.</li>
<li>With this in mind we have calculated data-set level <span class="math inline">\(sigma\)</span>, <span class="math inline">\(Fp\)</span> and <span class="math inline">\(Fn\)</span> rather than land-use level values.</li>
</ul>
<pre><code>## Computation time (excl. render): 105.03 sec elapsed</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="quantifying-random-uncertainty-in-land-use-data-sources.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="assessing-systematic-errors-in-estimates-of-land-use-change-sensitivity-to-survey-interval-length.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["luct_reportNov2021.pdf"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
